import{r as s,a as b,j as e,H as P}from"./app-B-XTbUoe.js";import{A as E}from"./app-layout-DsHkyj2r.js";/* empty css            */import"./app-logo-icon-DUzGgLPl.js";import"./index-BKf4NpSc.js";import"./index-D61l1uVg.js";import"./index-CiEIW7uy.js";const A=[{title:"Support",href:"/support"}];function R(){const[c,S]=s.useState([]),[i,n]=s.useState(!0),[p,a]=s.useState(null),[o,w]=s.useState(""),[d,l]=s.useState(1),[u,q]=s.useState(1),[m,x]=s.useState(""),[g,h]=s.useState(""),[j,f]=s.useState("normal"),[v,C]=s.useState(null),[N,y]=s.useState(!1);s.useEffect(()=>{const r=new AbortController;return n(!0),a(null),b.get("/api/support-tickets",{signal:r.signal,params:{status:o||void 0,page:d,per_page:10}}).then(t=>{const k=t.data.tickets;S(k.data),q(k.last_page),n(!1)}).catch(t=>{b.isCancel(t)||(console.error("Error fetching support tickets:",t),a("Unable to load support requests right now."),n(!1))}),()=>r.abort()},[o,d]),s.useEffect(()=>{l(1)},[o]);const _=async r=>{r.preventDefault(),y(!0),a(null);try{const t=await b.post("/api/support-tickets",{subject:m,message:g,priority:j});C(t.data.message??"Support request submitted."),x(""),h(""),f("normal"),l(1)}catch(t){console.error("Support request failed:",t),a("Unable to submit your request right now.")}finally{y(!1)}};return e.jsxs(E,{breadcrumbs:A,children:[e.jsx(P,{title:"Support"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[v?e.jsx("div",{className:"rounded-lg border border-emerald-200 bg-emerald-50 px-4 py-2 text-sm text-emerald-700",children:v}):null,e.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1fr)_360px]",children:[e.jsxs("div",{className:"rounded-xl border border-sidebar-border/70 bg-background p-6 dark:border-sidebar-border",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Support requests"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Track bugs and issues you have reported."}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs("select",{className:"rounded-md border border-sidebar-border/70 bg-background px-3 py-2 text-xs dark:border-sidebar-border",value:o,onChange:r=>w(r.target.value),children:[e.jsx("option",{value:"",children:"All statuses"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"in_progress",children:"In progress"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsx("button",{className:"rounded-md border border-sidebar-border/70 px-3 py-1 text-xs dark:border-sidebar-border",onClick:()=>l(r=>Math.max(1,r-1)),disabled:i||d===1,type:"button",children:"Prev"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Page ",d," of ",u]}),e.jsx("button",{className:"rounded-md border border-sidebar-border/70 px-3 py-1 text-xs dark:border-sidebar-border",onClick:()=>l(r=>Math.min(u,r+1)),disabled:i||d===u,type:"button",children:"Next"})]}),p?e.jsx("div",{className:"mt-4 text-sm text-red-600 dark:text-red-400",children:p}):e.jsx("div",{className:"mt-4 space-y-3",children:i?Array.from({length:3}).map((r,t)=>e.jsxs("div",{className:"rounded-lg border border-sidebar-border/70 p-4 dark:border-sidebar-border",children:[e.jsx("div",{className:"h-4 w-2/3 animate-pulse rounded bg-muted"}),e.jsx("div",{className:"mt-2 h-4 w-1/2 animate-pulse rounded bg-muted"})]},`ticket-skeleton-${t}`)):c.length?c.map(r=>e.jsxs("div",{className:"rounded-lg border border-sidebar-border/70 p-4 dark:border-sidebar-border",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold",children:r.subject}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(r.created_at).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"rounded-full border border-sidebar-border/70 px-2 py-0.5 dark:border-sidebar-border",children:r.priority}),e.jsx("span",{className:"rounded-full border border-sidebar-border/70 px-2 py-0.5 dark:border-sidebar-border",children:r.status})]})]}),e.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:r.message})]},r.id)):e.jsx("div",{className:"rounded-lg border border-dashed border-sidebar-border/60 p-6 text-sm text-muted-foreground dark:border-sidebar-border",children:"No support requests yet."})})]}),e.jsxs("div",{className:"rounded-xl border border-sidebar-border/70 bg-background p-6 dark:border-sidebar-border",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Submit a request"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Tell us about bugs, billing issues, or product feedback."}),e.jsxs("form",{className:"mt-4 space-y-3",onSubmit:_,children:[e.jsx("input",{className:"w-full rounded-md border border-sidebar-border/70 bg-background px-3 py-2 text-sm dark:border-sidebar-border",placeholder:"Subject",value:m,onChange:r=>x(r.target.value),required:!0}),e.jsxs("select",{className:"w-full rounded-md border border-sidebar-border/70 bg-background px-3 py-2 text-sm dark:border-sidebar-border",value:j,onChange:r=>f(r.target.value),children:[e.jsx("option",{value:"low",children:"Low priority"}),e.jsx("option",{value:"normal",children:"Normal priority"}),e.jsx("option",{value:"high",children:"High priority"}),e.jsx("option",{value:"urgent",children:"Urgent priority"})]}),e.jsx("textarea",{className:"min-h-[140px] w-full rounded-md border border-sidebar-border/70 bg-background px-3 py-2 text-sm dark:border-sidebar-border",placeholder:"Describe the issue",value:g,onChange:r=>h(r.target.value),required:!0}),e.jsx("button",{className:"w-full rounded-md bg-foreground px-3 py-2 text-sm font-semibold text-background transition hover:opacity-90 disabled:cursor-not-allowed disabled:opacity-50",disabled:N,type:"submit",children:N?"Submitting...":"Send request"})]})]})]})]})]})}export{R as default};
